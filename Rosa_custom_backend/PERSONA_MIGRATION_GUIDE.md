# Rosa Persona Migration Guide

## Overview

This guide explains the migration from the previous simple Rosa persona to the new comprehensive Agent1-based Rosa persona with proper custom LLM backend integration.

## What Changed

### Before (Old Persona: `peea5e466a91`)
- **Simple System Message**: Basic conversational prompt for video conferences
- **Limited Capabilities**: No specialized knowledge about CTBTO or SnT 2025
- **No Tool Integration**: No weather or conference search capabilities
- **Generic Response Style**: Standard conversational AI

### After (New Persona: Generated by Script)
- **Comprehensive System Message**: Full Agent1 Rosa persona from `backend/Agent1.py`
- **Diplomatic Speaking Style**: Formal, diplomatic language with specific abbreviations
- **Conference Knowledge**: Specialized for CTBTO SnT 2025 conference
- **Tool Integration**: Weather and conference search functions
- **Custom LLM Backend**: Points to our `http://localhost:8000` Rosa backend

## Key Improvements

### 1. **Diplomatic Persona**
```
- Uses formal diplomatic language
- Specific abbreviations (CTBTO, SnT, UN, UNESCO)  
- Numbers, dates, and times written in words
- Short, concise answers
```

### 2. **Conference Specialization**
```
- Expert knowledge of CTBTO and nuclear verification
- Detailed SnT 2025 conference information
- Must use search_conference_knowledge for specific queries
- Cannot make up conference information
```

### 3. **Tool Capabilities**
```
- get_weather: Weather information (default: Vienna)
- search_conference_knowledge: Conference database search
- Both tools integrated with natural conversation flow
```

### 4. **Custom LLM Integration**
```
- Model: "rosa-ctbto-agent"
- Base URL: "http://localhost:8000" 
- API Key: "rosa-backend-key-2025"
- Temperature: 0.0 (deterministic responses)
- Speculative inference: true (faster responses)
```

### 5. **Privacy & Performance**
```
- Perception: Disabled (no visual processing)
- STT: Advanced with smart turn detection
- TTS: Cartesia with emotion control
- Green screen replica: rb67667672ad
```

## Migration Process

### Step 1: Run Migration Script
```bash
cd Rosa_custom_backend
./recreate-rosa-persona.sh
```

### Step 2: Verify Environment
Ensure your `.env` file contains:
```env
TAVUS_API_KEY=your_tavus_api_key
OPENAI_API_KEY=your_openai_key  
WEATHER_API_KEY=your_weather_api_key
```

### Step 3: Start Backend
```bash
cd backend
python rosa_pattern1_api.py
```

### Step 4: Test New Persona
1. Create a new conversation with the new persona ID
2. Test diplomatic responses
3. Test weather queries ("What's the weather in Vienna?")
4. Test conference queries ("Tell me about quantum sensing sessions")

## Conversation Creation Update

The script automatically updates `src/api/createConversation.pattern1.ts` with the new persona ID. The conversation creation now uses:

```typescript
const personaId = 'NEW_GENERATED_ID'; // Updated automatically by script
```

## Expected Behavior Changes

### Old Behavior
```
User: "Hello"
Rosa: "Hi! How can I help you today?"
```

### New Behavior  
```
User: "Hello"
Rosa: "Good day. How may I assist you regarding the SnT or CTBTO matters?"
```

### Weather Integration
```
User: "What's the weather in Vienna?"
Rosa: "The current temperature in Vienna is eighteen degrees Celsius with partly cloudy conditions. The humidity is sixty-two percent with light winds from the northwest."
```

### Conference Integration
```
User: "Tell me about quantum sensing sessions"
Rosa: [Searches conference database] "There are several sessions on quantum sensing. The keynote 'Quantum Sensing for Nuclear Detection' is scheduled for Wednesday, tenth of September at nine o'clock in the Festsaal..."
```

## Troubleshooting

### Issue: Tool calls not working
- Verify backend is running on `http://localhost:8000`
- Check that `vector_search_tool.py` is accessible
- Ensure weather API key is configured

### Issue: Persona not found
- Run `./recreate-rosa-persona.sh` again
- Check Tavus API key permissions
- Verify persona ID was updated in conversation creation

### Issue: Non-diplomatic responses
- Verify the system prompt was properly set
- Check backend is using Agent1's message processing
- Test with conference-specific queries

## Files Modified

1. **New**: `recreate-rosa-persona.sh` - Migration script
2. **Updated**: `src/api/createConversation.pattern1.ts` - New persona ID
3. **Referenced**: `backend/Agent1.py` - Source of system message
4. **Dependent**: `backend/rosa_pattern1_api.py` - Custom LLM backend

## Next Steps

1. Test the new persona thoroughly
2. Monitor conversation quality and tool usage
3. Adjust system prompt if needed using PATCH API
4. Consider adding more conference-specific tools

The new Rosa persona now provides a much more sophisticated, diplomatic, and conference-focused experience that aligns with the CTBTO's professional standards. 